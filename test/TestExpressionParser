#include "gtest/gtest.h"

TEST(TestParserSuite, ParseNatural)
{
	{
		const auto expression = "4718392741928374**243+41234*9-123412341234123+7**7";
		const auto expected = natural("53946488226048561227876420740309775038453666175194926909968118667544446453631653616446072257171743196751888389102374884329549415931301254639911551125419285464995701570369209275928723552293200843147361695685953441832356530048134114600061308300163122015770480042877015153451200958838237283437816082943268448861167036526667588882715282480650577042532892616304599168903264200464737570355171814849555737704491386710740143083335990323453761903789207827706546282595680666507631761584090551554853854698916876960189534454618824748869336911609007648849566606583422766495199228603056852567137944235348533569781980881255806448387299352828345628613825314704278340175680262495951187003491694592029528727004551622655541547803261514547686393058403469427580991910237306846172727947035236065904683304731670516698323626160111125002110866429150227218171673984231777152164895634665144445334637199403007648488420105863676904701088237979602612266454430960330334852820538084907917057147581959315978899842505865037092767169830327154535486597617273430548115822602108471741802510767211314454841747274778743362421496488760956307404710432391538624720650192495627101090856443722310637838950698557456337388198289539342898850270884496150892677371244090012416783926163731200896449084654279629588280834986833130500724054830589070677121340059842306405544422264400207802295431652152138898798170860974747332436940170932689248066186838005915668633473870031681939256821268733902027866855481796178148137153018791101074205717596466551097377752155304230404085928597554697700305623824914879584578016280521039133434925691981140720252732936066539018877801753608437390715909794676599986828826620863063322419690580861616163955998059270470226191260868904804600168940795446018880644965710952515277477748355592033063672736428282759310166799354996075745974350407863181439550293724140370277637362992932900160251087505830399468371614581103059182158462658246954088653756032054136978470301653225319918784550393505893523123849292719446316507132821771502558247543742706003125087300841967048777205577140811770939505511387598645848014194222643637627749935300314374841537027608704645292552693538536680148326623128693403863731716604473547837913947674637428696114418250613193826300098676585952625145323593894072938272958651646934439768426695687261949374479806159336501204560970953834249401188877084666390855028567952758063358910486170304544417067074883923908842450296549712463227153530007783510516408651232716832957306325663588983380798687185385269823461680249126416595260616656502674635381242897053177278613463948539272472260566544866839293867312838562216126398243331708726648069342386724061096299447422821869123597132352280068604498177497795628037554213835662534970853001891408581850355926178295291031861654154472511174391023486137232763054474930306483368216177578686755770425658616261843024044154239798408695264065651862302118010126529893124162845817746285201189868761834226714112793867073503288791662927482984289672032640068819083271498048059792036529181303933785185984407493482244129679762607152577326188577093632840806955983331402924355265489943604830130157556444614981810244641683827546054312942718484212984949577448665578786353594556862814318089500139096930861312108644258874773920065341265177393634626835120997233319588353360163099321573727697729927602908922512502138193566565642344822736785339074958464570615399378891127220035042231888656838527749140219419763188490795660599170046280806025748595096345678413229904292187121806388104542488979180300751166824380763693058807977247364542008358006524853050092277960591458140996571789127027425258999725900811279169268527502764950229165812274112674081627031348631724676225079874350697445242931502549208402795524310935367442114468202798157389354115537756174711277181127548955835297814901650936225361420724691519820243150");
		ASSER_EQ(eval(expression), expected);
	}
	{
		const auto expression = "37+(48/11)-(82/25)+(42-28)+(75*32)*(63-47)*(56/50)+(67-37)+(98)";
		const auto expected = natural(38580);
		ASSER_EQ(eval(expression), expected);
	}
	{
		const auto expression = "280571172992510140037611932413038677189525         gcd(154800875592*10)";
		const auto expected = natural(6765);
		ASSER_EQ(eval(expression), expected);
	}
	{
		const auto expression = "610lcm1548008755920";
		const auto expected = natural("1548008755920");
		ASSER_EQ(eval(expression), expected);
	}
}

TEST(TestParserSuite, ParseInteger)
{
	{
		const auto expression = "(((((5)+6)+7)+8)+999)mod15";
		const auto expected = integer(5);
		ASSER_EQ(eval(expression), expected); 
	}
	{
		const auto expression = "(7^7^7)mod377";
		const auto expected = integer(175);
		ASSER_EQ(eval(expression), expected); 
	}
	{
		auto expression = "((((41234*1234213^12334+(2436761423^13+534123^8))+5^7)+5*87895^4324*546)-555^5)";
		const auto expected = integer(natural("6621446140472911590838230801658441799093197800673862635908522587524828457382823346225310528701048571543705530542424019196378105544159741188352493267432542659626166294727389779545169646843513918424206372287327127649407867371465712151398934785355941128443181427512069600944983388829414535254741893305709517672790968345407845419038253399772731375239899477340230855418759330014050192285361794327594777224494221558630945507440989898553733763019993122017626933625810774389857054907172141120577726598329832503833853974404480658733211709273482304371695890223019542873713048262380409203843278001654515950374349840345339071844622307121217024878794887725460827704523917090384835512778883200791299934523410279073015033578342206234760293533878282921209244648058171264893323762404742077543957561271800500880517981193701284941588138328864901237163387399859723660115502583517058212720859275293871094175924818362612811647870033131720906424033715242088092402464274993714315108639198860144313649857833223677144775138134273455228630257635995536021666343293949221802400975410327399579729930891369479162417138407530384587670885181284177303960490376333503006726817096984109039764610718287180307215758519274089896576679805430075833592481705657563799090953914167827870827697928782669743908593600025012371390222414088263808180719405870718471822938673903353351130815553867406828052614583145616912595763810630281360389300597847900127849524316105909799295153174985984352502622429440483347710286465195082218515870981003374260589447661745188631509143541630580354024695267201088244234021709731673808046679301074594090160849369004661929855671815814681968348067255186936151144201814021894400708655886906522048622012775512502322078516800562991240559531058663950221919000854808247542420169045008193301144851871558830720506982172697195756173571505058977165495303086228517140798000134322926216590498412176956944400001399628734610941677680603438230494880694583735894952299268250794169045092223323842029640647430464464026070944402101946709972265289237488028816015692542929634413526826899118082944310143068836738168788096640106575007595650971167722524145300228802612400340198859152869650857774767662156490953278357276617173498461357469232282910579588246322641290752850859080363833828197828315270850421803153740854706792411476769301788789512714705818220431851812796310382634160108136203602196562900434920612985193090091538816686026038664474612800056751937657400602077612875621536342717496020171957720432110784776944010796789297161481664523871688992208723743773162742566131621144716176437249225288043152190083108453288767890430334935892749637101962949525359550691412831355469455992710761239149268834529451542562701855620470121385752526016806853814045443383593418286671199531557408670936303411672930324623707200160480516900083699176243505743267076776901134224454011906132613519049921295266594237535582290793193590494236965632030150875920256000008936223782107953424363494172953506249511018418535029189221120054532600232054635196662022718558356514720907610424793160963484108993794000693621069390272069548600251002743895308402797213197305429121664456500104066593051550286415251249866724741285609728745336172445850247228197119640492635628463077292951595729326785072739756835338547370354911240444122866903320603679132092501272729547092393116283853642208953671969267927092761020373342626626921737062014373650014215553995510550063596703088842115328170471808705223588914057410352340354416065988981742021380686646857925160972313565238135652325529694055731356141393015223029581051641007330146426196847295713791044954161550617553193588177423408611756158911216353519632173637832736052582536511086427866047084980966162230661440272874011607834444593174349504960904127873986990760605737921566651724482521444183548741090898916957363333991110770934030298161655153593322088636746016055378774206270621888425868426360606238291013035502556532644843256067462596490802172071578198488463807492805170281932339683105251188839662806830669141536112626240309584324088774149472991872772560585233796370656889073531698433851365434368159233744324143912091323614000760743766759783657695183344888654136195170309657099653686618523330285906152811380714009002278812436712243773309499541941506725617333494484532541534836356903508497470007566500071523557637968287691958478564218972332944810119051866614794767706802068338565784416596324810027751312014440330774316235005324126891313601794615775312859258571034141273841356778620371600168985322934241038420009838007633833849525949717316659277631578368441979041745427210959368208671122754251959598414967782662900011180643480367944722812849400752580892584470189343892976264326058282644746462213249221354159358433166184964126959383567304364439772966571927953098649473958014649148738010578154450310106823676185996831375008126643982290384544592900658374186031986177505019140835794473618649337700531984244152759754430182344488916128373659195093164045709647803046964188203447297283967783202532167164209686218613721187277827004902236492386943316054975952847966783117838884481636546224859786116945566199306728986366572514823305561512135332911171237040852635897815087034350167080020834112722793198693294157089037344409088826808221143016454543836994272462672201717543193787747880145577981323755280617939121142255660067329341568956859544562635942796103043746860869162630904880571086860538100392152269072045770007470442184859768422017496524056360264472839373973425236746131146775660408818658513435953130626412707985110922969038968131277290085136725830780983375302092522836630032086431438170818728260756033778537761948869306145819844908130213243809404202562825407257105986918088456070056179489702263941394272923973990188537131115489652313539846678517674668595655964779402288525847851878561344184420987810074012802775752240165176997560226430751447341153334572435623816003966351637559719459811324757935311542549945731004011102487118695764976425629048635967710946057224920543772627372824372378826496343311282324314875756889127513519028554286459568574999519429379093858542365116570505910435442187748819539923030458516641887740890400552921024976716184906542093589784538761564131693306686298299771171310258464123754229640446065262955461885548044644307066382530827644112415390492054963707745162454296758967649170732987290715594440832449182944761634963818679249482248778085300324580325301826920452896796906367977883366737627234757861236476084059262041019744920127529408465376815977205498397484789915995930708216102750731964774492959573524320290700641497268291249988198985737422933155390270090923415740312984608729498593608701498910923289824377952856849379389184910584558389661769700447041929377016121097577044321670358834811341657925757058181942665689180352403358787008290506562754451743273549856221359920997386504638124319067673167624007750466235435227902716697442575552895566485079575476828617313002936096538912834870667321806909582855308700784853829323500336539850732319651579589685462459198927253466473574201138934468009363877622300572185874647365027780543068276686263492265360851249614522568080369262792583458564614212526364988367523573377148452286645865180435430322761620414575992302410643326224909514353135567074330242843499868985530463137966183498855222386004369710200508107554192897017662616518268787996129852076716403696047003083892731294514273175335771542111723025474624799040628954916928915702701743061901622845296127384111652409729243118667073164547292164598410958558846323886928573296041444716569772940262226192160382367362309836346107334098465428601235316394343806246932575757442669334032744839996937519372777979876125299955647646951064365309352907537464873978395884278130078343648520809423695609441924729244406442286082842296500101165785527037764392547896041920707432319623848938411635470586403077832851334442432096289401256202696421956144143483715474114837453309345398419704378996036741163329685883163526336496287568737378779774729110977144027806083551046286752059053395340716196687802926408568826768356904500393442756749043944911456243744685326982418638305586361640275682573528439485630071275105655948703083841528666445308204871373026323321959172310994000701100371710400428359763737216560273477241117636861063728975269094097214744873232163058200527420494785516364419825142442616880219463167521267790959453223923958249248263950668006551956379127755354350956823019607081439881374010376300251682269150385758776265107865140325301061840867706889484784894177932278805886022741243991180271462752198976637153893124070278220271103789981971841137695411845105604496600454322662489256502937847158909829461763384133928279532484193357758907718962305341688802546756699249219874916815182048438244488898459680746515186392318399844598410717263555394012173934034698068059690182374832937695791941559212709054760577260451109500033707310867323672334195491386663213773206365320738996905830114904925911787761740163131611134705506500801455077015843385824794743347164186874961581890998014504785454355523464102309150774118004631181248030523305706179630733361341694430848268301492593701124778379125774416576721231130356559548547909766543391066895060704033118920041663494420303728752996439372723638792619170732288033177305470963586130492627484233453227490283272444025191678519209557515407619102860481117331562499777355406352521509237778907468865301354018148535880162347125792182130706880758819629095622988030330553410085173780161597982704934199997316613547747280582403868463190537279762610802702411010082263742543811500316184489602714755058595131653796939740651204301419189453824364643478990654193930178317741222810341176610377774411234731229579707254701171254854075528959231780307314563079690897001190257054374646312245377610275107616556187479405337982656184016842760254728743312671935859241679249313784952758434959837108864582351577588900844997675416180970343253191932465317515748789596006969704084019691996910504960667360132597212159222958158020882055031630591065765166341586213946226822005850922606192836003940769430286721790924352300973084894037109605658247257010205098001872859582644349723819034407553154236679939557001932286539330744439392330337675637795223255370558764502056562484519680934227837217722695256682091555102880383142108780819855984270243804620773749161513347673928040261698630487801729261850849381120447193840998102023700047123132177416330030089595995887193738665607016386679834582044555378967240371186831038787820728743220665781297652593312007270222177767134951088158256901692601878085937524453943189892135446026193606366556624956582470214790656345111656462732774513699318264524665662219822129086853487167928228857597931451745912206548621125216803303385240282828475930320704792760344952908797582771186383915857143729909287280787862340007505255530400546909350221723132210191376395326402553119183636361887960743923800105104451825503922246966639281792073483750649159590383909611767560948576034687977641732294051854889477026230383516915140571381114959733237155499151108573853059787231242779422904247212317200052999993437831991878312228421838039192415349819585962686745678607942442652780457350879603463265938345493254133551249857978974162920134055463605374519177773071373124497262325102946021129807063360620142144173064972558745390511607584114505029671633847635983229949823743149512346796546290484933580006983254861376467434889044220738055011658825652080039165057871375615169145105785913266949537039549370907793177042312145396957358410495146495014091414663901124502885693317939250348779186946702153148049706256304401119752188232991545449410180536804415762524214149044106706199670345536456008921657119204024842982662658182374291115252264536486447781259315088800757463936341070970477940895486661503225374681083892342402745675008450329158952415183409350699743625172074516582205783574501121227485715758395766317579299892868854695794610444285571072978604645376073748933103630159027557184677350240831484084068804162322313210252567468026807440270678858377072853636882711075648406929481402789942082577539414314024801435775641635431273680990978310663889627923616061141857703387545399493011280935565109768913420616347520507799007161967097415295164732887557761097971841980114082884425646022274965411153410936884438088347768560061698069309463469453762484498879998414540207896811706120288544434693854909074319944158573827124204441422167194329165142323086914562003419839750118022560397450788236270429863294640508589925611496850099234182096137815830377795044560641691618503523916788810533152768422426572760250991569616248156090471011294949564920576029265736834252969986154807211949496864531987038769067715602145715022174616818900236579803397379083796707999731217146351856261622099782661040953151459621990300276246873051109388558436172186939801322557971319083818887058320877703797164778176146303036601849532116796611077605147370894717224816453387649813546791776908941009961434729673857214415972269795713080597934899948376867017992550312000971914481670543501836821121154182034049731164384903145025895458959576893378988526336960758585768147050543715932788786001083222403860183406616950618127634484936497987542419996813735108041676927320250109747767209802960906458644498604453357898242031342134962786972399272826541657570245087840528092575737397770532495845101330174425700943729841909361250976557030539767729341646793662237194531522378723128658788608454706376554625274888225721043572260841766715259010483089444561583057358720878386547889796340169829165984104732634125947113258036988488280621340914341338759120543264035116685737680465007720580712262805278167814590772951469677829644974213767838703124023215858052587440925284953053334693153324694134051073370530569809092365681770790625703908346789781047938102093324407976783166265121475903704499992735201417245503882489133317081491434500257505123578157756947222112611981419575074877861631576598471972893716221921863255510671917239160861110950290591779734414754514598305501454937368243033163585203175814247929364458110874898085199642237462133684604274971690629457515934490506084175362827622436239668229753187503621004087013530708031098618458631697803804982048344251832129760127180916403103533181022393826337314532451057922220938431060534837355228190291457003689145993774400654667353991882661614113916629061290740136118742370058931003867527830275298273546293459954689699145629579685513444648933440843245444516079855800174609700569030264454659189489696618823671029230639309031079902844537758601748593572402329071760664576867917802511931887433100640052711480976053115186318942410761765161778056587739619429074833695814965295310691963861095444721408683721218347407635790823217230733506402615461849242514283886960958298176943844583941070787340336321285117878093572173973490377394338685232498790687155977771528171254929500076504835749403416272989543789795398479861817988770500392750707286339891517802673760937667605935592433370383825150801079383796996257885558474665049699400351695570960668547733013668312758583218046427104593455545464984465298087263703847780456755851508700414208904246623715614362541632774770046463504896205151541623779380334709382696263533489629222475988831751259021292376301980956827034802668399401109813608240502969345845071384841277700594735527654888332288321871660880048405307835812781051351622199060292817295905781400631257329918191647967572142699472300537744216444882372247802256207910950113221464931811559019715627140950743623286802945101956697817689363602721274704645600409880849466489429300894724829559872801678584502201761444850230600166472656443675844999334472058295932926265094685943642514859182859228909605627059721843046213477183063010265134116350537261501295136267188723148959368543132519440271676325586209812249116157757471380730237113332646861602294710011256303952912523990858694371995632792610223450746619483939758406693075894843321559381911475620897995638478147913644892246631025609530744058113206422576831628060355967896933285348759646217783483187767113928648828042535829629002278111076966046574275236944315461990054697368745712041642697441641737977469084252352156009119751576686983501164466987234807767984519230047639818801426174927404921653503938806247004117494368226161210804752411960053835046484591152702446506103943649474833663897744744807148494537899143619853821047847674057658434795869853177880986530590139601609647213882590767084260501461576630067320876142631735589335166727550283607173229711362448308543830890721781910057712879613835721707933485671132982811616786240164173864222822197708761842231821456071912545054883327189573170490981233188345071441443223254161934587774810333123175937747643580105384485861441406707739698173288401091524036221036847420652354687772497877701262001493514450606222630183072119320574052930371336343086324603937593216234922418165715769887289593917638474546285188854372182566891698529885620409436722446565631755980360640655610667719272100918230240607529716820910905126663664936819273045435425480669535297486538150785847430560833668553175782732464676517766751071549389476647598551316398946786040937644985381955508883925682158560488363415256258370646941437639861576440773007732966980676971114689767873383286164289748495443786462433959623170935057531985920757693640789265349857770296427934840075593575585155307388683497130563403623053910464514378072897601970185489457946994221673952612380037627064265707394994856770653106118860222898871974215884654168508226595475091599274435755371683062969992254635782962053402459208340531096983443198688753168089912736431371070836634325888705382350002639715547814103481444152512302996017083975831249385222295960587769666052298657908932852983556164263585768236158755901552020699508236829996228686738415902535808157276062444088047502460359006441326234873260952915680189586600798888886524977447018696874316326165438812285100454514968801618516784199059306705587830952223226468483634791125535900730149922738848857852225808562321159231830607542456970204139436050739709989768693441647545210436983761063894482318630530450182440741983289430691792520010911650770818117161567687390194050485271216451865780702649961054495571615127125395006238729667933715959646286033700302122600122555803714985705425446932949886171966657338044343753363234968105148497500026456909560519823552311610774492884472393085739773972308862194183462829408068103233122472521289203703927554455950723110625848665843645899873464562731907176695601812162561561084260155759617199408753441026779455642390232684188757106474399834032884229096444033079896333019318582873809862178941215037007009535423264456146758359462966047265369158812079465212122155983506806198137355922003253320894967993997303623161823904011156214636090743426676661052111623015290458533470085238148201875149144596953078000081020266213189940199452245286733139839955239035439829137465751909723935883227129524586582327349439874438052742327584161078547547432775508823691085752757211288176036448437269413068382459751081951193444248361189834367114098168536255586401246698157895032391570904595715235399901238805047069629576982934442251704344802526349077284619959919289731620289488550349148104207709216974975683073953760555837076968624969481784174942578897393848078215451183847491498993066846196767774469268379994888731206833166864578550972834763733480092826817690978316419214919871512366783135166907449714903626691531190652650517939838004679636870463136145514398194161443966661529237487244154430140561861245037509333676373922052628440850658849491806836180382625631877749856133194670298399590272044552430635202047609515312181603075895076994342674061827384054480020377269509255121633336784090000112666765482139481260133212497229613669201234995719418735372274865428174264222236290303661438370476768100706186595574673414168039606277812397439608217687131574603843691231422731841591640998780853661373768244565608564003618352769636853430388516068871534776354083257675219878780563365775694975182009798695062056466567987823927561438044881596463095355633037556712817682865583186729006196730105902218999208282712592547695938456885862473284630422876648243741351268546195900207646457585478405593335478200199182870528678554598799429017236607356565497298897634686996394974911028765366357619212356481301193926244407118129055023316755917642434460024744025616223068291089876153679378134789403492614657835293883188171231362601973134799867571725351960265887159123502976074580847676196838658057083112986542628882839720481477273452305897945861263195441559210676794001557549901191218894594989937697907056277490432276517420554882419120244703303205767804334209940384523587711542146508461073195643337512394745189906218622326779807081720263609424657178736602957639640651809663885387617178933621155577215303358238529591245963685777409749852770962581298522159422639506875859629971551063145143469216332178642755669009915087378489648028099934597212244906258238692372118807553260548309913852670855842724314049254263328993915459384559532044658772024201845266309973146255270700546624371227611007621919223687830098056084668045469919149162584681005095599132460944007871295102851668361677960033590820258349120557762276627446679162462364638142205269534613443410640067299699773968363833313161196166815110909278800584939650361283548150327323134473884884181297224489249344946804150225107805319488989389717177719702788315999585861161319286866929463289478664727970404455656969241675626715602329969550674608957037191457732106978741382710805160654575732125627216452909470617584391733261794109645141676211371230016182734902414426681148757755433906445968855338141804761889642191061714095887537921648515525865094176502886277900460708152728025052138641723168361006671073249325763314941261049533724687044424560233235151873779689417161499680930673341524874051357967789039625866349195218440690828334020994815972253074152896588230453108722939908631993417705207801427805310323875674550361339108066993651816053805587877251788574004632395522848276367525850558569447925331234532475974925070539854178136053614604762783380467553100931735797229570414245466161810709644354913250347374220410422365658798644406499064198345639226438245619328512798388021919293626281241500405760655985863556255370654775727131794339316074306460974365754966561378570424143120138430847604997330390003046190263596559971397253880405596456686820828241366734405015543097631278564025934079534652256499550380869084841727455230326498786069835659170571922346078735901709987910274855745431701461281585567725049234198499718661688846547236864625344506467975307857387038315552313398495782406456971640955430965523521841904625841257947430351572910849134137852145256612094473606584229485370021618817825522982605853422989652175515713622763138015498802109640138381017259253881169818752231197214736623028716224248042622081398284535227493828550010183354502622086898288048787483669584130362163647372763965625760148679741067415788363160034930595301359459541604173947297037186845651056041314173952262669837630684309119464651097672004373517570003321367084916723033068249755190287670150900509124821676112401460357560993186248282454554715218093121035557013210391064728091112303217407791833638462131372445147178461339836550356943241210771823908241792746227723429495147120340502969636764135029297834727064780606967773905508484218102407270471978486697646661839466423499596117180996310431725785006324619093517963533158828666297219404722520543382134454912735772074444471799296740750136534269658694580725843167754932222383876189849574898379845165145494582506480087147758631746742391197862617268651726046461645021931613772193915036221366578122169432588565286833005617944888433660799321678726562794133072496130981816916473939430413246891349161478358891021224637251364605818890953532166036308238533073489787938028806364063829929071244102275459029707404427698326443432927413657584733548817525539947629018746879775400068195031957482801996614945953656884515270798039114494733802269427702221537809165691319083420486833195141383656193927547837470090786913607667442897603172869321116948618306893983152651888404112595021378450998411296258690631560680996309378882614410466175210880758477160392746264505084417360235779569380509528327727830971800475333203609783969659906833024986950639593554198003186236035581251634156722387005495419505609136047341835422583450588055200002706780739170308183586299303638622727394513522350937500417630372601907098794700653887295861186176572978700519295246372469169178431136674795612254604476336277340513589208769783247677661199447273578614510766645009166039873684370990037317856137295444811199491208268225429186743687113034579907033322286281716319815360605369011734969127304614988402108900045259480740413850122143802306630284612115551570675440798767267725732536114713227320943053867282369111165951802057667381279629616336157908927724792542723842691531311376688096066541391332065941685028967526968823223222260839861857046010373448456897546705765754992612877471331227987055737870565665359115012538654406662940722210243159912216034172157118774036320903114568959023538083104161884903493808000986793606159601937701666218273967780741762290168810403280871810146762795813375350961267560818639140815809068475532802886078979887371472140888627235906057130020727967797119981518545217246660134999307454763351190478997971121010897904570807307370364874141930961457862220061149899183094996510564613853514565456395539364239969640397879939570688850133939256354128609991784016865234437082238569391739974262558454598551668853914746426425127452393695490495299910968734649191930350770801505368889322656815062175850526019055320967969970279181347412023998859615309400020437628854223958234186155580795432987971016845879061813612673856565788620126972851862095850428895399440614062918524571125019775530208645823371094328358083215312634774404284950557858445942815191198531972618410170480025344619337715562200508790494214169905837428091469474746504812019786459299283104742737546691716184220084397262464597907089171308173493661133577868713165005867063462532898487913190754314421944009474561248252317034139721804976398258122770640641148818927281866385241054723795248541367026684941379327022331008400642523274178270630947316740114045583223365857520904332496186264965098653444429000195015232359831243002927805717763472979186589006647437345806845343434622173521540647965691423996198383483458478638382406330368474097248296656496300751918386895869144750376435630210395382861394276142710222677255291724667634504773482895001583115102411848403325604152828620593668388402900624897055330846200053447905257647535469255440214416525618280442494459464305892070387338836108845495036407302384679702042056373369392175491414147417674787877676780978630724564884857670400471306163116526394612754579503143629291101643015055486210191817900819607760260410713139091535541224493774481617913881974099436716250055359683570699216521613544543736193344087284021125533589150181754972540647690329267408788922002458528411714546171992140942599326644280277978705120158445706183430548396125862526546365706768836860917113808001615483647345409693523992468982282890436440877758273262017666970315179155260285692119761637191982921149051673178373900872450807023930761465057799658090836756034205208697041924100545295436312647303608476736698415360600272378962427498599201001088825024064108727260523752747308032800633741632955014756644510581221645022262445680102513117482004599821169121273563377905521214505002523158731065080358605382405569686969013803904502227537345447632206203052939938425431931442557471405432047973057559490832435169376975608957388487452057126156736507990121303129229176332091035052080776823029387119402713611192301073797024088058790921982741007817693494848832712103550394401383032564790837588763148821935141811135528115982170921997865639642353574787507146262545834961938635827466278591055831239417327998086318193807602973616778071584303826063601426735198270080859756317310071803934803185311198093955047511976238436774156188081616691599484535077893277937534642736051931912829012728884465317310717916230407423411747479540679448989944764439246588705480309841181451100860923353881712781282170838512612944536701177540010647618488637208359287642142841960988201819565167799965780130322241334974373276895605190126922092644560504163201430902048455273301843044807588714253333976616808417653233252158967112432342333496655542730530027155159872557462521329662152169565030405961523246974966104564251200840579893810723152833868245489741890431698201791079699297645167224635647206066896515782820581601378216630482530767592310693098716916185578016453875918036520749575359166830451441350076713090436402292060781738684647242148732045486261699255002977962389020211991921275738256710100295864831698557468283161405221819680623170398788826012334715922919815907072455511830206403014189047695438597074493115179905590329053441118903362384682254216814835119184764810605221540563730112130077393987338458957894205462971963714926378397444548339410029373458041094403935479961531015168755654159523331479745224466722286685709552623250731430171619203459396885239552236529676152276644131980608802550134199043324278425155983563387121538937256811741878795284553473479776897793829550861345208186698401669687298302876385956527665190202813997724069325497503164963597934063055359132935812276058931489571676703840600503665986967069743997266526000143826935973580756661271085284626853695661375607995465060402685955502852087893034344120028501791039038537370848617810785204813672068294710914150477367816496616163321953101737874179823632383702915936500846050237932632210020422507399427789303199157449349594657052210977677583931089293917265180357686748820868145694348242037737632740146905935253136382179581363566495909657710588211428510510950505622286361905781072363304979010019597684474773219514859591409482703268971379137422169691701616853884712043728648314969052103346306306052416917923812292153516829118063190197638057944219034430723294882498128466581822271446381634954427199898090130144406074646969806696741897272618137883578706998821757384832740236549070270725366389757658622817655532810285721848126552868870295825370922007381398628561298146174623112852519653616093177502489483320566397687493083473525612041272586001629517134083144502166545789798103621902699432068157013040935589761635690463258400523875704742582607755720778646387372937258226535085616926858992346471950779958125557128393430688133274966917839595824252440686064492132605328953402727946356256074721932097206168070638044582989488592579339311199008985595232541270804539929067630987673039736059440353632384615013827794229231410660838750784470860995789157041216271791276127486630167655015825563680526537745479397558292493942151017263227834446355259581281444749879707655842844976978449423540114087451352006560111988993676518976198643391220886197681450506197093013856607293921770891436981462392529845460838257888700021576379383548563089372654086005523890446584327116269542330539510946205390704132321087522517511400222671015236506300687570585462760730474470856143624647564975014749102455570195918098616363818655337968223933606822070994314444503501975160686892307249447884291169820232822843350807218283381391526050577784327967274699549497426445834235393766151042123283493330132424922694684342032536631692754968203950459454850700773365533973065906615010860064785712646311463479916374656730484913829594966088790916695269505280063650322126543237818021524864852247690477106272243939084971668097721885667591238867673944836594205085324527587711234949714495769762128094853152997907324191445245105459644673235097671791770041499044118045026681583744952087808795793587960506638211442232651266060446463616354062863205176950037029028237486599270508206206088701310159576566092968261411002018875947221397461920066557705403914965801624385480785526851956919240370018990125229408258246704353217138406186728379143827090062298946780345430582893769900993130682389419264511060691658992512628622086340309505454753354022619947468394800268913863890155590293921427093698445665096598732437178958114094565850848914272706406455575088195753484054633533116231791197739216256732112572710981582605278512870977420913854304050256939433231822219198784282553413265964356554158655945228648624052133702143835627175192850923224710405944747075011751372514086610619128678723176602633020303300796616067503246904877093531717691310754168057190605744197354043804443520329220254982291091016588510187184716152770279414125526452962784784511882321630899780755718815235854221636034165943499108705512104123803999689285516150812178808015479138850437770757379586904308759509216332040915205364963089111543044938251498272947317826241703958309991722049904935563160313585909720820323342082630562245629653716495070682300375524570486137439689082745836989625952609537494579741204333312984659841672224481877210541489701366557435194090374532537814353937898651573435166875902186074324093324253459868541851418952680836610481289853219017398324702232258227357050582739032061515149744776281167052948420592492683648012768016445170043367101231649121215767608582615414000989971232681350550866695641724469822552585225770853916629996198719695509740882144141834742277065462324693762489408764963313434843419708325783434686769607955030965681316193321522981841851763639170760668285780464744166001762585343945937768231686536675960098648728085462298918135919124490550664957913705460277556003775903976438208338012241697617456825854478063532727635713508431238579140802701677613362573002983181905381229713361554555202711115196004688889565568362939588236556207420405865594107716141578182527457336915529985974838371982570613858481120101221617882778244528633435196285815836261266639444643418175973809406540430645718627568922976380909711107056320189001948770587391950958302805182197112129745487122121172415934474593896857679140104918459960889477945414407952567566571562418357986860007100278874854596181194628835546722615670110694806141628708326729389811435705968070905333560007706335033693783201935890345625871832636422506501177066811115002226554763530514135409108746770375474250919463352998739180758704580750271621288171673350033986479945311426940885868579805402409567821029639608299591465215581286526441679412355111910982246089843854602814442753085246433912829327831551111409553835105351315948713994088534249539474664973822609151215922991204768851764615778081815905750714886537447873167218267414309846862390243592978528712955144421065806930853453166125041397996786390083165942133962879164870321067918979830847681149131938753328346450682835758891784129226268449717999328578541223860288264098744256450167050046790713342249624158296222820651112091200119727121845943311820180513010079290469162517509927141471872048516781986946383382134222326900541351847051728964359091217389390229823329256598367667350118435540292541437380394111958627798484494854064119547410387121685418924888395239167962569468527820829625678264893903126191241505407839180482745038099107114257068662921173291740875348374061831541821378727779942116105902188024355315708368295780293615872251008865311462264578727272349413711311009394388373337787066865123872634783976108141755318096352132243961606521093136787096393359832406715585669127681649686383096376761265738551909816454408923384775672689695474358724801959460126341270605023205991747308251614286153601472974312817096675656478978354113127287646273663780059374079790155104728850373843232059107065430992099595137236440109483252903786321502348105349859088709238743280933698180788141443715237192891765705108162298115295844907334454002525846974674154310188808302015507021724310695041497271538444367041902211409399767189258913346665799529966888858318511825749958156902474436822175817408908799268744089811128548304821377321441180040270909187993123637685485232328847750260933936364615805643049928516687008058456396008253834804625017741440196576509813530970279241679746199576007071357961612300887718573164066928211124844262828108675802933233094823850426377867022362136347274817295179388300701160817862414461603191135853152220970816215989896590977638864072047870508290137103751295102388276771501965718953702240235651940701223845436876002082462200965564998075824918406023340435930822174489653842366121001946402478425058201434848229556221751396902516187325209810873136555420041625416300966816208736070168076264041145917735238725025090424842763434893998381444506202320339932148902832838213990706257628507666266673946272295529198274505003708229591116303415084667912723593089840855398286822293598715855047124224241955803029879479350434813924696460315303015511762732062161688410896289654320885170238228984650119280583307065478228662227871738016638850443761654400166532778550663390865537866635301607366102781188093793735983179418315881427361131504089957322359277138250023310232765866235675447778160622566394130903148124859768265486960898142942955441668170051158918270265165483976149100576587859321001044492587037319269204969959693253429140330664560407860613698127186531336721591605345286224179121238821666926623755514163510232187010019747519926168871892889239800262452538239026506716049597831254843795979827810435982755566226455542490822448708694652976640415430690174877513420277235632947850554971249339782188788728071873936595651486544452408051470750682365313992675151963861401948522600224948728931611691570373375809238995908258548853037842968772861095109691260234962016406291161891384760902852312500620977470132714194002104560334180466946436803175790349656708502768817072502524917553726419865419621431884330493486323111582481889517328323189173558302802793779019593850320085808183414951185005595723705396714895280106897403643347537998177257935217177986389223531144103217028744955667182519778102869460606428659205203759612353830100198728591358408622857447724113510944980083702138773443836824021445543809880244888336176852032669438701378356242299690095134563452103405455325004322879481568837246729156710495743040259475057768772951564889562675903311151739034848314690688199950755777725791793866771238489876650853214342258493838222834831580101193794159260756854978348181677543254618114812719435523713983906263041889701596473014085213992483625501303139768996231304753149876853780675427488825640281636883089071319794013046055328611475860972608272777495238228656439074305701322533482118471046489777949066979669373696295861062633689841121268336934605659522157347983660458838522508111536022998363520555092588868397406729293848968837841290908106107343726342980088714875554840992877695286874144796645007232624507342239804024201020835566367157016925801698211670732910812494865195966886246525850174973212497794658853784959011938276335775224270846213219871216998444955483412596502451389511797547913912862361714382160278790124557214372379679765603133697569613197305534821355937137837185772086966955062177431151509834712799773663756521322441627767031298057224236107814871437706350124087042926051269984185171030268769944443788299664457283737079310137001053916702233475663851009956980445514249671037632513570339316593776884767948782427567496134004728355713305526796956928842912475143606409489712250462585961351379832444435938345843099804416439808691867124406638207812245340503999833165144957998877184171312098157689917058822826598975329357917217813231591566305486160901905370041855407167009404085302400770940423810791134615287146162740575826782252790844967188142212481432226386543413856204186232565668047682447896151669952715575996418319392248637349205541411169553324198627670674254610506630776158214075414005929154686668793266517899462505353707999464468284578965155720871123168185450344429276871474782780162053051064506485671009864847026700287277509548945654277192226649631480514388855775883085490874584551890130186000782532498669176750995975199638758645610034274900622282262525187872949797173319595722929067121501232483372482752266892300824541140521908556536790813929246390947146312332329535150115770606638304375141658742832331662778474069294522147801285289981139020619024790472714281035073753352216955171070833062060664506632724141616444666796040588072108614631704577736869704864463788484531189838898080601870432516832498237435543594415206076037882611349237541608605264648077143804144813526756601845873135982988330127311210253916321293422710184562999070688298147398699378638024608053995914885760747680534430431121368790913197105246974244313621580551582668131709145762338851861689046187042750867751930238972961058575930711967500118016384955338246819042539422573058640022208609878887098410988022041267989098604083443770545209849949421737678956133882918948498035769458306952438654490672476582890327701526303164363452797636691375903954065774072893144544469711498028895742565558584069804166999921240242445682461405353096676743240848888552082018830568051172757250303732882890066066228010184487597661882967827261928752855250880734303568275236936299885041058410264935836516294759504698266040090546440897978815980189191251000778477625914855744586647622560760072784591701130474194869966423904058664898902299359044701739117798753579522865978157869350849585825352685282549631718044211623390392291110003743388411510712620358670127976735013806834854479125266692919419147437535987078051033488908782409880783552151240158629526290985327375816902701752443292718775608998136881141800977762816896659306318572306628014697622447477053281689420417826818312608026132986803454732626086315691308259988398007742538991873414720727419886393300747750190326505234374827920962389915583579329795360038899815831939108630763059336935100635734589328987324794638218395269212259383484144505125688419831235453058432672425262387544843422686223420028056523953699247073306827614071350496375286901397874908749566592422638071539109736203346315098761682446080400763684144231868888833553265407444763136361650555903003036151093257853884263894775739542576101575133515604924534338410331723413622430567601985758807086326398603958163229641681235799344192125965917888226647621380096482473529748492758760533671364853570053729324323740989979443276684935656559004605725316653009102123618440298893674221946217299361149039358672635156186480225692273886669100566444890434961569809778825914524008895165624733157513336488726372589397731676946352190567374523624956531727802674382165547353095722394476231508535180045360700504972613059175611655902592062394346617855241631206329851861743243452396070600798028361524070421284392636277900911789423344334579363551930371576415517621268596082461210650223505151272459746134270024557752196245743204694192063322564988136379997700039825873845210722069813341511216267660100005425436602757852875835274975417364704272194698499648630523242332892340896731769717333923724033892087319519344570680334458572609778515859244553402625599669409825469081776909002360938678794712569622332719016077729216919420716103467199200394712642412640030717749148874406931398930031726241269528294594307816256642804732374596449647479991358652563056447131247357261391705528117505786158416514930994070440716587454730774816072894866605177885490365571681712763601756726170911849813635641269645336836789464781409138596037063025444438703163077381311336556278855483160076047573458105046417568508000204319053824092441854157735759171631545836352953304866797580202534450687498902107594393036819596408240982167239226331591541373538704644164661759800235669513430496322746688833797547370952168262495029810169712285633300263985197295672057369703773737155429770312887221936645541707674828350035993117521200993899195302043930862005549760792149169238778851677615457203020799206518705928427606516642652467634685755277613527529752550311712985531536082395857385202024283064153433202425596367588148247663467164920506548859185634836178321019350477999333868746280492015313083779073959564666007183217680930733071659027564076258487236801492897091856813536728842720294669564464148285158723520119382631443177370028375702415074305626026413449891344600134953675644094129696752596557102310227479818259509533701278700220780736929569951719515791721369352539686757304322346451300220905242467434160114245945603456995161785268961967743062700879543548557059514874427554943117149898362859337220010844193994885733690675135305950084128159338471040982187151176900125703047446183292820109191683643041304260378975987683417036642175422583107892666649536618695081865400365363244402133284644994174134754689591442598855798165502360934056179921595135778751932056432684306885297609519768811708148093932637364560783330730573542761778355403221182258411801723653689161283760537005004606387480630373486896067527694837775320516910495059645628582465822223207034891865032288247976234577738188361424771140304062787383135226948159752433989481967396539638951471352489348019494098290184283945595688945363730470528863969661639994943171414058857883806837936400973744969189645601463725436365912098956275436839415311575932545212591408706044970908922994001401588598798151865094374674821228624712077894106848446696842183878813619934373254925206881201341821705572575446738818742195537117226761724614055512952465802944582764696893224268912843508266708126306921935368476998039758418594426933204430260007515923096836532755036915979763861374690159067565357692790892908029157476002101345824883282450701117867115351949473206294511532132027496661148717541349404941733423511743129481071291785244853002342866361596187092992642540551816496394015987713736167145344341485642497870423881528580572513677863938343192891080036904513730887881982153551908375543993104281780938891744906658456428627222938189999726314229828492634866696814610447233251684692882256472515516697409506911431286050003912359262464119727986041923217286839526801957301035181157196549920602410710705186446838166393993563655362503384037214643462698573108669065366301212294396647812081099226768830656964984900257214519648156906164542703146875208505754816437130672077158806802930248418875513922694893494139776821752190504451519956020017111045402295125418515834695588003329169265530509357815974103937062873061342985487049042751242307328116280340120670539511733349499573592243500166329214317206961830048821615310007066022495639471232171391792799895958545008157523314479859379132050527421066898873372000717953258204639071244271290704021701020738791455723380367309778106265666097030101350492932300165589989720139609137019086398592127814749668929326837420775753502892760880287092990015783670261313897594369185757926013684237213914890511735741951434872633933594393995180159466182483394445314752803618952392232672065720340952502630262691147509675535312474251513807813439534532643193212992922356900835982831603859483162745724418449650327074620364469145680401264603287839815943751103771828374468431388009210621193917367518544494824431447880224842690459494890478279200133628012080585852025349305081214331319361498835847141080240504580041903770195632477491499376778343479192953941550747762285460675656140080619500010722742896061902904312753128615414064105144930669121865822965192711038800946365804848656690603669449167626823251322936053575076560182804619573424235949450462942017211793992316613746475356468578910490862684194118621561174408176980970715115669689573804461236976186404866934198501278731733789805358847687607188241021072346136128411878055242251565329570544481716602135709358934620452163158749120183224370528830652415590516963787388678579298445495838343856575399653181739710028324302226498582662303518231063530129328519869625805280089455360635262489871133172719371932478052587945651734307421121119937898142400129245406107202495921134264807871781250902518657595446913961700439854185814654480862593452171208519290950930293368847785720924614409974003381457800698824325701290182645231718627078926327553566914294631032992448706393065025216606390841734354238629044198072878175985327333040583242422928542361694643154469711697386544672037435189883715604430179970558632157548363891254848404928344757993083710216449796271412414252721924979845705202052400023132012454287526365170619710508303719957120876689490394299286197195353699335707317424925075421194057245447817088004893493141191412626143575449093483462550438087065382114257748250950332206028621858454949680031247036341076901125674508600969956738414582728918416189087814506231360840495521077589931462994993561703754627177982034252115869267753576096189069245441401544246714789994668332192798631538911351722601859349513438815223355095081282847284652664931068645533804081053069999204027292028504002509980467661335683845034085578263294973144916528824531508759548425982078486332089386468851160257712675455761835195048409933756659081536141170832310134053410139875174063632474189505165165441790399402168510314460229593794805478514521445671231426053499121484359547374006409350385751023587836388497389232967036282582838927690285242422856535141879647375846852314390175800451180116016736248496275397688627097155928098937852477054733077385028439920869538056962188136700538715386443059373460522504271177419993812235917814405226395416985416722802973916902020997985939298663664183212570269514640887027014119080955426913330212037773445182074049010660657147629467411909541826294809007669995292761811028049731945673824736063030118141755841290983659883966452470629441412950922640744850372855020367246991091148465691981991391778305317870484742798741908825878844721329503137730413815438416825980512516078599120080247601337349256071513832122003924647745671238406428698206920068136770676055000792866673442860999132084907930983195455413129714289282309549064699407759721014414568765010455244176794940723344653223674459874807981919577325952081815312847053625025526523163674572730183097334395744591183746351582661203265053847411972424967596835939815251125695709457855646615260493260942144358512849101781102405501273966403668900249465728538328740561101895616183838321044926111092118683890364328085237707110843453592020475683152189691431794853393306094935770757385098755253536995116208465833625656357638597080700654509232218911821239605924474561282970398262107071119961561681899240800090964170372436615050869794701358240330173815167825932370002972128649926849605146401731176123278884950143415202339264334297909358342545332075182062660236973455906119084420433021242787402554274081780933729952350486232045203656568487202312482604157086949160894603894574532425422909211918648628867642949709464468477261735258128859285709721474595664595565651652441213595434684655660763525444817144326476516398358562313678636534078435105249852131790842910297918856327947058509706201170664000635287154919300192938617830526834072965457973583253353934101923614986223903516284946370170327506483317783025493480199818232166721966344637786424488536729860897633505861446539992280723472346106439897465979987280569963404791399063320269344304315400624422751398369117571315320065465150530134550492429537139473875111745119098869558082088855044088314842011025692874785303205493084673672500542134469021426629847356925327658767871804801158646040025722156032965624236520058358756889417862877674347575821440212065053381017469989733455515498557635342681353872359950842877044949747228550712824547713546071881889911030811733189017532270166551636126000835697707242226921745410666531704622363659094937496900961292087537597591807012885629900121200868116329005549391888424090304837084001029350067721332113823768694224062241679327852351369435536828370050185454081837024602130393344121683426941467032320136378308663922203460502592928584834045678256737019131411661744110585735561320090989463727476086836605191722330037422950383454682363531903899981412373186145072960882509640607086147713148380044427097326060360458799700996863721496363361649084387535700033326145959900096920079810655381936796259730059155448914539906941687095027246296931203946272947503074622137802083387699182023454776832799648723137800337894165209721316565839690419439910559198135111066541999400985995672337231127290768522324949166863806922850362897253725274856124375828935936399641977597948421290694374085779989479332779421169633803958030248444966531954897394533907320283138200374997512638258524337278794935012005913859156155744080840616322321782913061339465431010686642708567437856562853469042652988008421921762614854898066652775941517421190508335338633574121093877695979936794331559579257274288936375035254382131618358774466600431129470927561770515447637942971084556221279177909197309731274196185143723600238919341637921059593097629797643226480521231837128279232210142461534579857100775370064925909043478601064934371113022140854069032302252147825879595123519935700131431051675154333743473254839897857478932982739810963214351232420820530498815303587039246087066684606888970961832925694560442910895061874802194318632603039790450593131741990609961239752889270401458133152305890846978406141684548167585292409698699022131463100571624689363519418982676526618809526017477553824351274544894306837660802879796671648302189065499643392101586607399227893646388416908203803926643616887319124341730163348542162920594171055535623339104936304220023756755277140430166506234760933128282945722432129584189797263561531425145125708906103921587931158726648623250341686167868347037142065853448889566459196392015553758449394274002334089727961130478150929529382927761968986894091112900978564315135948734541650251195321464068163992302542091332612645529851570159231160586569913239737092684211385283514532176852729016586077713500554211489824598515237746073455180926881229730528605176346418094791568209062438640610439044192324519508325174431486712754111624672379547970840758482823289462910202321837306561549888398277227763482382501426051344382257044104493809006561255381499601018617253916742847245004262614838933370074524048706854678413921732359616866361659799110089664873623055141490406452710693787978726971101265383858051565072780874448521636104859113019099371369536593995107791798833170741226911478888369753483251069877112769473577480681827290777842422156516996525646794050765958994104780574639695965868779366271969511032271134541736843384057310532085767621144930142032061252965615827945346242111649749044453096050136562355403087071027554935692580662290670581955841384791952137093031310286569461260416487895321926612163439210120597159822416915644005860992346782213998994340471079592727609627058751784576526983246918105209177713401795374870630230759239336553930040712093868203962707085601219976696545720145885339393228534286038141609505618264234535124279404180740144707893240750341388670471199302849452946825988320517914140043225299090962392686390846911914849251916219307781364039730592082713179457552439417226671253965633917047878353315672204690806435156129056987830040587438821828788540458808988296484850203186591754958211030860561149285651425119217266222285693248848272526442111747727189746415410227450006709714630524913202639569166801167809664649577265331868448834478333336834166590647012487247026599696883088989447818279680980162543260371100877395093743178930952984273762620822899912710177858624771837198438218712170841114530193064207854546041326083674449497872533136288400497198433721857713562581159465699733150576388590135631364017785656924936627048609202457843819789765530485242798331081223831890974075637157457952897434945861420113248028518941859923898504048573715113482397753401302997321360525811314614043875329070650635454452017483112418552873693607622404596954617899061207907440522169253706492194994220789903914764922076602776054634048444801778642796777960967199494881683281636843794267218897697069007700275069384098268327054494616985735971074662302821081969159357084493295924659738570649606000252296619828231946395482157964252493691233849992800935910872843604694927340346617896325058989131591871923196425857031266573503250456821071485346980562024942378350803280732958188078376581522148074790969297222095157413606268362611103799017161076461508664875011064495702643682868736750081188661723310328831478661099020508904865808318083047704728777188052396676825240033240585161939406353019344813544797141152176233426621521162922381350044037124776822960570420248375021454837266564685882005266566032506018988762644368630184074341582296843066398276820114628218158653218096993434497706527558389487439844842719175213699152769758148060053749991726516869179757651291511249857129755244953583514109974932865818175696961341388244163803485913054981498308816665789361850230607052570377962294981311794466773160841573444551394278613276728117426596724873822755318471066164690106501516695635690411102228322587826061776123054616854252412789814128526923976415842652103110885746424319106728262000700631700601969519347580959930580857427580400113242922595071921371230977763317050433233394614737017376888307494559834261299956453727323702272990784551823939843508055878646032864172083487550146256479140120346261691261272371875208114447148127709764675838410083338913289391225572065592960263863660516220576982457122490079121157647946705295079320260373801470109157626997447999390940913881408283492900810776992155161805559758497800671865317219922008383496320949255129824174251037978928564431481092911705163503749648726456393219960149526568181306824535196992013447832592558103586663794331737276692312706913513412741402988545522705440851116587639265179124859114909786869195178192294316686037313893641455951005277272664554620026708954721250154845459834253942029659939449127062664041061756971731923130669967837223881433302646710136489078477934105629155310305314477472612215907409583799255041569117786434567029385025311541378657932782214740548667744044762529139467705954244975604494164150088905622818695778399792854819803622158233012733920146187187362437113899272669866413377153094349723088880798840108559643241564188957725752926683272263543632519437904890665674873896119032589793980578030537593909781387519104221458023311496930198108175583233058420432629066723292913894857872856335588042966640556309908972104218202051278681600637514368911891821272009832766631597691257428641391959707136994694475232321855167746459181967196324569845902846349087902861493516942552389289110611496005879472995967796626844300927441767427415090715880250436755214288905463253382350892814041286351342999875307300435292218306559735505503808840726921655846337497213697878175617344231652188076907486768684601075393958177084993942263981029269190424578997032790400683058243342482979215960570947955120726646559128723813471201836271374256061609103959327628658952968687457803612630888527644978421229021071360963338138669658524162738638505741811199314402422041314611907415584970974027704741300503449718303789137985417673996668253605590698324675353238928028731685903996726622271636849212751919568495753696243326926750529824065505522425888732282790743950721815410927089767329145793354523885924654598224888371897395385391738834750042548110382362170378975757893594801338831887975607142591045513178662414000536215661266688553260774664781172401852000305621163947577272082459288040204125809093954903687499527563888765685352049613846722549656582237284013088765067504372155283714125898251436815512254179503395882645713037991580593749593571840023716829172622812651132218215872529447220329665951664486806902549915941545228663703323234096594290658294868774551517539236343922795789267300699581342108571122616595453689319922137745433433058311662248671500883011344147288880212877805100320925432786173784378543004496565148209107710895538440871048132672416137158901003755072541089933463387904319950781782510292523956568361698707201905576771848304176622578896840545217301810417189724257300133277936837358213485671249734052969083227051333682070594429288664261171546599485237536821933119100791897623724665934776240650132009558222080365460064803033257461488744489878390998151011975856935877245088064806268792486930562704108486362173023704909432309165503065123285897879082191232251905275544002024953125649452709835546175940925848751958296358005175029792294914267366159997355716335457109215354190389100405436654738777155268396071112637816275633786150538889753041738037395984427138642034750736963900434590401114372973889341549661230592505558374303944075940669286640935623151493980457588280681511901611760255630786052571498497815592269066995007838437916827931839216074234655268228482617292701878800733232431305202737979023648202687205155075788120806092386970017948554729098599195285164289693908717839069816648506741494928353864625776479490979160691730741319184528578390357201418045618874182496735155345466521504028599982085652455115592502123050896293068818373186011988379325718216231858576620914603628620253996933669676652059658155139578370329249610184633563431965614163268543235338588452791847272273773772910659440246631224843498734111303243240346655776616880523270178283554975772979638819624932306728861523439367818856877889083877421618782648214669696139315808389389054141355490567052695680012275016840907732859410693991639589407198120049897513092737261296035040161704276989324951419519850127655337635113391247403216922819420849504569604317284382703881356923791804287800074848773216043234934740021485686503991915308218405892671858723033339907023087442112227870825977290418894416725942494884774022191047810731913433650954069021074209453855954757930150621991979226958702417232903735332449155542246143586515513092560992465331387764105886687045160354853386983986398889634597633016506370516949554270918107797517870352935015178090104682493417945221192747534839443188910939251829524805363505764806818823698699760310358730523172236079706556093242401982604491383909919858770309754615652964577448082111778957964205793289932064626536531854684224042574334026056177739223901449950321723076876748188477557958306501872597960773756735068014078317282879912005483530386653768857488912230456959622293014117493287260725491007453251036301834224690389252290802584638210955249941124812350209831376950905460698482149939573139351805978693438488860859863509161082044023280144864898098743299209316231543119295387724506850515734535619864595119404840308353315363058590659483088875235435356964123697797939465734853445714738364522512817975988279697753292552986952446124124832276075258074137563910914537661038982831380563188495689579782072235980910025904472244065960532101858833982286111694559151447846984100435405623270495344052851889032276169481788061891197716110215517743246618535663968092097247372223966774645290616021216694568698208742565511756188724927607782359911830443605944637830434015245401153194719899184988528511446237614284315999634885981407264932335413279548936959552861356206408754758208648812794919639516413653212346854189281454593392339085396527123285871347416404457409664557463581769354597019300809298513315052979169175176404348308001569635039425354518693965225154026577511510957272614577021481752387917645013322628322632048938424210764765268843863687949393436851147839610912811923466886608905720681590752463556312478972338622368573846021989906297609175761967271328339904588500917323970981653908181247815070039584762614364681979494138664907178039497137866353558259201733431104041176837948551376206303515596116868798047029696523926288963752471113673309663952380674339516014427157931944865087778039235160624736965253467552023307715080747299924819603417052509404207262362021948969938644154468841521577412603603182858453220590160326613790927700574560067513164279785077224350205608930829944932506066266197743352193252208080781156610888623863772551784731704913971721018205193126201413806865106696623362454128430927002568582264385522807678972959589660520385493693920543730672599165367727501991864422051888896925229398890904024761793253238774314090166179680249599165842391156035775133553088930530024445813689666670804937682401001735921755749485978003682097908546469985484844265927998265508099317632701349984576960703304330951899740022908099664379099028767504499039027543064178845511775986758737560393356931495576857009492669986064160188065015442433183140125967411667249742036826307641936383776181985321716224375326679705344323959765181845661239577457704425662484443686992017491568519529263984436182479387463942106577782830470334884329968150888059059228178414274279562647325892593497154367499388276558606728755071937879113163861326933410071139364352264122836140403442793789062764542186535148000041976900214718442285629450455036200110465864194734026091023320678788717117954355997840836185742494972548449975379640616199186844745497103323147355717910025934852357181495223951273036132549898762913786384665634436794604650640048288497719182308921482596781229723198788247068193995352813241687950776634546731802872224497556342745019209065006860851233975085608213477118242857940125971146921818309011464704991868434832478417502895667593976724940166889470273995685223375877808944729317090658905736254338785895003087052903621343050985993961208455132881684277036453479454330707394214328879584277668554958628584770259358782975174416560391534526308417113035862986226684147808581350732202105692255905531133721724568878962456659093675519602767647536007343506459565329780126895800196379641133676391850819673804701092433279810793398961528398465424964547082722225107273499559242225336177846729274046652376318737732305564285787115326887617234009454138945109587793384589608232837340848560943469802319638843766943795823017772977735537364697315950993075652648051854431803995753796544142055603362132490491769590048385733439544537065763128827093664132217915588438901963460726890845541496063299799472113341727254896445834582593595170446784341019096980923618654437532256832573941050540193917848236829945842076996602282674800252907417089399623072733433241789706380052180249148112549375727632610450742014468901047530524308828835435495003448493459379567951771728515116423825475887003244125729878317652890473744653605936985677239725323485254500048127734723076271679858080835041150703060965812412813707131448694801063259146916006491473194797486252929388029600788602410061567777818070906955476945786433772400891291172867886845331289904013068704484821081781068897875620836078912418354153352455135858794286781012487175502023835104835023325618565683146972153096293804284340050764548162072052391662196660326183026012270727633886684397763256612763850430961410623235657653168697602796488125921173182805112215022997325419743895126204567784834281989197403075084512949346803214268423922865759871767010938256256018114546148419660818111955039617064416688103804233383378284629125971287171751343977764413068584986417747738772811187397914567452443638402531121081631545587204801782094834736754832579456153683242996624005036421893936845033653657373260814885858412419392140971356202356601393639432482554648062211803194237199580027775786254835794114465609792740085626254018958240818153321532356839043994910808150396296565960411570510223895488353555093303921239235573936610400298264529707284022459357313684926424949532280134207750576661525629100598385502912753900208076569827790402018440923449011379996418261599184847819286381873352195987587352205644395074929313086962088783433602655973169048132556022552086937863394303252521960576207597910629648672057427008227606485363830109246693465898590471326854584285798911375152787813808237876302614916709080733600532620727594199740533917575453121676699956012264551703265434764941076336251354930786606768417787021634692723425480427917121511065793691854989151102152888010674221061664346592107324819870158822876555218774299033368163919113272590917187892226831767432506966509625954932743201130991300801348674986665836168246172922843786788217544272862316077650909686467193802874003121563891560978404119738747184496139048478292186392153740619261160165828829495173049042735757584744973832242122846046475403919961561860744930901029397591659295240416802465476647469546726595842006835922162323938050511810452644061151495596477211394097962753562630517868921559450146112400553108197702064748118090056103759285865669466875100144041413789597984757107178785608292193847347397719897026898302629037729493187098743325131573013477138313067151451883103018115201848777162685770567634886198658662028493428261498048098733080293108332451247491363366340769017920501529852050192809204743137635772477276846318574080722486623769200432999950811592584413898521890612073584301237021103892406833621141713025447159151637414586209905529843734898711307193416867680049759509567749752196623272717870913212324169509348923494981091320428551912351856768576955955591081047277332522930432760983855735029117106807244095263362456515557131030867823183092645500313379492771250311336928150635189065387000523661689981431605260963257104350579310057021158100676254415521922055810998716497961971684891678119125098732800285750125908880579843657297345274421842953923503928648680671504368747686941134133749624444895769197768865722606369991703912467885975683552592602403989966590660904898853098401762805824772493960769168092510682880499814824252828965190966321600717889143609927907435912672330134370219199448609300167871957235557517851404347892392391086850863530337789738027980387679369649728122225993396210132636899665824265743735477955893223213550669394900943696650982888120706082076710877855818086780066102614404491006256028283232150463007050212041250637483614296233338714234254097453922908932553011266428379133842355348158015552140900937570241601070927538949086940836001088799592279041502682598000878583406005300152403289956055151826945074870206468452010131992804907333227163842851548501183161992606738898218266546596150279960151459154078783096572507982314735533697322579149440441871018631474267605666459031822909275623323294910847920383267184838108566875066107235154773133083800248733672329859024308154375514267311397960149817757120419045915421843678347815764383287982427200466745531717014063956286735079238733796182376932822389341541136747861797222408292801996354411141653365475054444016574131395836006716397635734742530685689146980144676687103818510858279118598002447475397355620908133341328532554086239752748310510002637828244517450838108019077134131369143996190841932507150078240182572366368207405217916031374892571377302768572117453932876303882335925974980266912997969839265013002191307708765480418194382900339694546223613483499292029452965813196956859498411488657364041152706455221928522571682873186465836981360224756229277467666192492668380781500002920781105893267337127114149476484744569371778827766932149124047906037873899298651031123245691653114768673925705563402916231286066143600301063775958701790760900557672981573629546666024396531973915972347931752818690647275499305606576784015037432415582156198564684134755743160128291205347927335505455230139847177778487860915000715677838715715338419966164601010749558246903113306701060460812704814128886672525236673516003097825285203051943224646160775561881148329472889176465462372778590263428260515826423091784309919363458076452977729703919130331944422928805654944520030808196911683011542538242429293889860762007816297872271608767588893676724148639341553286449214914338761928492625106688851410139003813739488678926529233990414705418019487225239688589523478238084806212701939175910081977955226294123501489863646625463015426349118422824636036696458754444700204147580323630533231507924493225279223898156970630631793554180931056254967724868082182258829876662866304176468802533415920646236029945884276862604091799168863507206018783615941949033848968831870292047399328063022877752311338799012391334975918847070345129042999271905756285832487883350700767303770857906204614998008058630237587086841498115063991637551391671719167894339386002221320788543572521441911860825060916801368454752670528622064686794935698131576331732330011577219985168520733441540490965718792505186543238867990984208043797734816784874464106226306994150847066392385839723442322500921384817472947128390200844443364067873135825040138080153439597966386879438046401951930085272765931636252549282866131328204266449276804849639656095356008662881134196499877688600605687276612632040383142985445130855701248221109862602917178665047308816043941756278222143600447921379858223509790953660483659731833889491092127122173869501489458399076579878452108480780582929504827628231782471258156192084817151296598787793685624665885848840113717042955948438692013635196716622709912804527022950042345330476854331892981587396257415048050997122046869280458495584030753271301537346390811956463544983545639742960998881498503810834101216194483424738155086788016933001427728166642823293269615429996451043527776607061733093904931774875077322615040516341026361693087466277016630744640636063978768693783845782718567892642639282276145020335204312806444088733379637143985779455107833054001956036528103044276807584781927880793602383643770256538741707381093544594791721094215890198668635503546842302227459447318262999781583898291824366557692725837318252366438663881630970569974284103179404772126318707728338938483368658059222307140546259051995783947266071091163763961333477059641752640212399481674248409223525767137010923838223772008112209205505844315374699207026001172693057046015319684497218976867811621641931128135461400385098392702532270029642707759282505148224147567049306968546527236199861544536937097546928407357117471149695180267110941067576474193584937298153121585932535738668451433668188893392082867537974580653668712816074289050025116811420042457973504236424136051256792253310930478275345589084566766896864643912444095651276296480413865728539849281339511043303519249862103186755963665675806557712071452087356576646187394496736277629578524243737727756497539384613911559109488091374527719064847265162900619234773362966335422860901858911788053383448903078021999853484894340319192919622371686785281885477487326039282264319654994600391416094762866535902736362472350892465586561143296552367325238998037297612152968697901010431765141965527997271408551604628102598856566003265162255961647781337687522792615010508661174567524315068907681444423476184172792697811940230918246241340349835757710388233161429626601509202981083669604403779535943009095921995593986650758350076646323180990192111757892196603001900313752814104174171439823765853141287064290981561147837341876619121843146879276872108113526925238488630218049898695793379587876889574621577011499694670072828107718992373168865465236682365623102089082124950531365240796214687756746414435780218991792835812513246946417839189467879877794474981072292334730186819972688018697883837650881403682026596827742687386971737862421748409458634788946481151553717516174985598124873856733386143978564159735813645947142949601427400391769111679837421170474512286336284749400170762370918194526617964006479782516226925397664600704182379978277094243521089544321984090167214742750191834393994486230366904941936052643095930310642345385919821440456666245642393257261823977438351983407230754425435435949910675416188407131423015996994129026985766102347020978899699176882374890778008092317921257932964563290204708218227834357639204469985895269964871374048118429834942579194024392614964363049264467583210667388444254473779482728543238560776573860769182477495740328279242065122466835581076599473296631689877723778859703767967525296343550267332808780013387717897351447020332487555196721234287447231403551287615403270944129139466077555093114451614535475824291294195204661722985786550919531618189254873277086373461242443347996844826443523898086209925371656504822202697709138591672024637322906654418261009995869052496996357319737516976809434598577550710485957123339566269510390508349737170425023119724548914055635744632014583787804887783647024030185558107552343997931926445454763352504087870859126153039718227926802476234448339219919846092670054642989458871005465327917548436898155342934123775123457160315359409762990"));
		ASSER_EQ(eval(expression), expected); 
	}
	{
		auto expression = "489/(28+833)+(996*454)-(891/493)-(254-582)*(864+586)*(580+151)-(219*869)*(621)";
		const auto expected = integer(natural("229932652"));
		ASSER_EQ(eval(expression), expected); 
	}
	{
		auto expression = "325-(900+286)/(25*453)/(364/66)/(58-295)/(197/31)*(104-668)/(46*652)*(254+124)/(75*557)+(240-727)-(885-48)-(574+538)*(975/139)+(74-305)/(69/50)-(566/385)*(633-101)-(841/418)-(607/114)+(138/69)*(830+668)*(407/48)-(446-392)-(798+887)*(499*864)";
		const auto expected = integer(natural("726449799"), true);
		ASSER_EQ(eval(expression), expected); 
	}
	{
		auto expression = "1421509385794464348357809809526083801*((1000460007429654466845447355956685624+243356203573958579948797608192227933))/((192800559571713719855156835520024265+1913036709240412251310673058234820558))-((465530421903782416466442698932568359*79817270389782845207986091345167915))/((67626230922444992185091655398094446/20018522699403567542683818783153035))/((19866637981666826608420788856126071-670185044863965449366545648229709872))+((933902315741951030267672235227796588/493460481027656612176601284066064321))/((252582335928228231926757743456248647/75932041801814485020875316083835605))/((75139734228496316711002178972842924/54040691344561163255347252039966622))*((1782269054953193984871018204585936754-1741752390618950515601837489977292483))-((1733511829951775667843767726829631183+839955076272851402540816709780620649))*((379048790755454619318849084536184321*632099555585514801941695531256031238))-((35444775654303440653984027511458891*323916251240097158799102733319731841))+((646810239173040488978536887183671181-1586585743591275765590295025602341101))/((622304440357870872726830797908425313*104924305545202558851466766673262376))+((1935728522137349249256119619091509493-740612642670240345248304577714871091))*((1232421989335888618623087546291917980/699034740300067214369800003585093772))*((1166298967541738243713542663434810645/440570170486957109508667778022484379))-((1803795393989480110577088253952760167/1796803921669994581011053594879157350))/((1686936986622977987828256900523747551*1158391505641231252272752539614600131))*((1034103787804452867846223029011902302+268423521422146847068846344353566856))-((1640676986541563248242381785548130328*1963477764458505044959785921417199919))*((659227351099964915415579477167690037+1370059768449597032992772684115115321))+((316930266613365664543943983977898899-569848866547533543252620549661238698))/((10862187084715078281373836777400454/6463891132918922789389984969102856))-((1635301618811245112790017076131352820-1522664232059709738599534879010003403))";
		const auto expected = integer(natural("7153805899820380115298262757795549354424156012906918387351688070588654355872505013246999817557253052433573445"), true);
		ASSER_EQ(eval(expression), expected); 
	}
}

TEST(TestParserSuite, ParseRational)
{
	{
		const auto expression = "1/1/1/1/1/1/1/1/6/6/6"
		const auto expected = rational(1, 216);
		ASSER_EQ(eval(expression), expected); 
	}
	{
		const auto expression = "1/174/1/1/1/5451/1/751/6/6^6"
		const auto expected = rational(1, 199399525265664);
		ASSER_EQ(eval(expression), expected); 
	}
	{
		const auto expression = "174/1/1/1/5451/1/751/6/6^6"
		const auto expected = rational(29, 190995713856);
		ASSER_EQ(eval(expression), expected);
	}
	{
		const auto expression = "174/1/1/1/5451/1/751/6/6^6"
		const auto expected = rational(29, 190995713856);
		ASSER_EQ(eval(expression), expected);
	}
	{
		const auto expression = "174/45*34/572"
		const auto expected = rational(493, 2145);
		ASSER_EQ(eval(expression), expected);
	}
	{
		const auto expression = "174/45+34/572"
		const auto expected = rational(16743, 4290);
		ASSER_EQ(eval(expression), expected);
	}
	{
		const auto expression = "174/(45-34)/572"
		const auto expected = rational(87, 3146);
		ASSER_EQ(eval(expression), expected);
	}
}

TEST(TestParserSuite, ParseRational)
{
	{
		const auto expression = "(x+1)(x-1)"
		const auto expected = polynomial({rational{1}, rational{0}, rational{-1}});
		ASSER_EQ(eval(expression), expected);
	}
	{
		const auto expression = "(14/9*x+17/3)(x-1)^7+48x^3"
		const auto expected = "14/9*x^8-47/9*x^7-7*x^6+581/9*x^5-1295/9*x^4+641/3*x^3-973/9*x^2+343/9*x-17/3";
		ASSER_EQ(eval(expression).str(), expected);
	}
	{
		const auto expression = "(14/9*x+17/3)(x-1)^-1+48x^3"
		const auto expected = "48*x^3";
		ASSER_EQ(eval(expression).str(), expected);
	}
	{
		const auto expression = "x + x + 17 * x + x^65"
		const auto expected = "x^65+19*x";
		ASSER_EQ(eval(expression).str(), expected);
	}
	{
		const auto expression = "x + x + 17 * x + x^6 - 989/6548 * x ^ -1"
		const auto expected = "x^65+19*x";
		ASSER_EQ(eval(expression).str(), expected);
	}
	// TODO: unary operations: fac, nmr, der, 
	// TODO: additional operation for nmr
	// TODO: additional operation for derivative
}
